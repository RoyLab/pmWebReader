<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>3D浏览</title>
    <script language="javascript">
        function Init(){
            
        }
        
        function unloadobject()
        {
        
        }
        
        function SetSrc(src,type,Isreload,eventList){
            if(src!="")
            {
                    var fullsrc =  'Manual/' + src;
                    
                   if (top.ApplicationContext.ICommonService().UrlExists(fullsrc))
                   {
                         try{
                              if(document.all.axCGM!=undefined && document.all.axCGM!=null &&
                                document.all.axCGM.FileName!=undefined && document.all.axCGM.FileName!=null)
                              {
                                    fullsrc=top.ApplicationContext.UserInfo.GetICNLocalizeUrl(fullsrc);
                                    document.all.axCGM.FileName = fullsrc;  
                              }
                              else
                              {
                                 document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到控件</p></center>');
                                 top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                              }
                            }
                            catch(e)
                            {
                                document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到控件</p></center>');
                               top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                            }
                   }
                else
                {
                    document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">文件不存在</p></center>');
                   top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                 }
                 
                if(eventList!=undefined && eventList.loadedImage!=undefined)
                    eventList.loadedImage();
            }
        
        }
        
          function UrlExists(url)
        {
            var endIndex=url.indexOf('#');
	        var xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	        
	        if(endIndex!=-1)
	            url=url.substring(0,endIndex);
	        xmlhttp.open("GET", url, false);
	        try
	        {
		        xmlhttp.send();
		        
		        if (xmlhttp.status == 404)
		            return false;
		            
		        return true;
	        }
	        catch(e)
	        {
		        return false;
	        }
        }
        
        function doresize()
        {
            //TODO:这里有bug，deep控件如果拖动大小到宽度变大，不会刷新，如果宽度变小，则没问题。暂没找到解决办法。
            axCGM.width=window.document.body.clientWidth;
            axCGM.height=window.document.body.clientHeight;
            axCGM.width="100%";
            axCGM.height="100%";
        }
        
        function SwitchToFullScreen()
        {
            document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">全屏预览中...</p></center>');
        }
    </script>
    
     <script src="resources/js/3D.js" type="text/javascript"></script>
</head>
<body scroll="no" leftmargin="0" rightmargin="0" topmargin="0" bottommargin="0"  onload="Init();">
<object classid="clsid:1110E0D7-D33E-438C-88A4-1FA6A88F9A6B" id="axCGM"  border="0" width="100%" height="100%">
           <center>
            <p style="font:bold 16px 微软雅黑;color:gray"><br />检测到没有注册Deep View控件，请先注册！<br /></p>
            <p style="font:bold 16px 微软雅黑;color:gray"><br />请安装Deep View控件</p>
        </center>
      </object>  
</body>
</html>
