<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>多媒体查看</title>
     <script src="resources/js/MIME/multimedia.js" type="text/javascript"></script>
    <script language="javascript">
        var emHTML = "";
        function init(){
            if (document.getElementById('emMultimedia') != null)
                emHTML = document.getElementById('emMultimedia').outerHTML;
        }
        
        function SetSrc(src,type,Isreload,eventList){
            if(src!="")
            {
                   var fullsrc = 'Manual/' + src;
                    var extpos = src.lastIndexOf('.') + 1;
//                     var ext = src.substr(extpos).toUpperCase();
//                     if(ext == "SWF")
//                     {
//                       try{
//                               var swf=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
//                          }
//                          catch(e)
//                            {
//                              document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到flash控件</p></center>');
//                              return;
//                            }
//                     }
                   if (top.ApplicationContext.ICommonService().UrlExists(fullsrc))
                   {
                          try{
                                fullsrc=top.ApplicationContext.UserInfo.GetICNLocalizeUrl(fullsrc);
                                mediaObj=new mediaObject()
                                mediaObj.file=fullsrc;
                                loadMultimedia(mediaObj);
                                
                              
                                
                            }
                            catch(e)
                            {
                               document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到视频控件</p></center>');
                                top.ApplicationContext.MainFrame.SetMultimediaToolbarState(2);
                            }
                            
                            try
                            {
                                if(axCGM==undefined)
                                {
                                  document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到视频控件</p></center>');
                                  top.ApplicationContext.MainFrame.SetMultimediaToolbarState(2);
                                }
                            }catch(e)
                            {
                            //如果不是media，比如doc文档时，axCGM为空。
                            }

                }
                else
                {
                    document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">文件不存在</p></center>');
                    top.ApplicationContext.MainFrame.SetMultimediaToolbarState(2);
                }
//                if (document.getElementById('emMultimedia') == null)
//                {
//            	    axMultimedia.url = fullsrc;
//            	}
//            	else
//            	{
//            	    document.getElementById('emMultimedia').outerHTML = emHTML.replace('src=""','src="'+fullsrc+'"');    
//            	}
            }
        
        }
        
        function unloadobject()
        {
           
        }
        
         function keydown(){
          if(window.event!=null)
            {
                  if(event.keyCode==8)
                        event.returnValue=false;                    
                  if(event.altKey&&event.keyCode==39)
                       event.returnValue=false;
                   if(event.altKey&&event.keyCode==37)
                       event.returnValue=false;
            }
       }
    </script>
    
</head>

<body onkeydown="keydown();" scroll="no" leftmargin="0" rightmargin="0" topmargin="0" bottommargin="0" onload="init()">
  <!--  <object id="axMultimedia" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" width="100%" height="100%">        
        <param name="url" value="" />
        <param name="AutoStart" value="-1" />
        <param name="EnableContextMenu" value="1" />
        <param name="stretchToFit" value="1" />        
        <param name="uiMode" value="Full" />
        <param name="fullScreen" value="0" />
        <embed id="emMultimedia" fullscreen="no" src="" align="center" border="0" width="100%" height="100%" />
    
    </object>  --> 
    <!-- <embed id="emMultimedia" fullscreen="no" src="" align="center" border="0" width="100%" height="100%" /> -->
    <div id="mainForm:imageDiv"></div>
    <div id="mainForm:dmImage"></div>
</body>
</html>
