<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>3D浏览</title>
    <script language="javascript">
        function Init(){
            
        }
        
        
        function unloadobject()
        {
        
        }
        
        function SetSrc(src,type,Isreload,eventList){
            if(src!="")
            {
//                  debugger;
//                  var av=new ActiveXObject("AUTOVUEX.AutoVueXCtrl.1");
//                try{
                    var fullsrc =  'Manual/' + src;
                    
                   if (top.ApplicationContext.ICommonService().UrlExists(fullsrc))
                   {
                         try{
//                            loadImageQueryString(fullsrc,"yes");
//                            theImageFile=fullsrc;
                              if(document.all.axCGM!=undefined && document.all.axCGM!=null &&document.all.axCGM.src!=undefined && document.all.axCGM.src!=null)
                              {
                                    fullsrc=top.ApplicationContext.UserInfo.GetICNLocalizeUrl(fullsrc);
                                    document.all.axCGM.src = fullsrc;  
                              }
                              else
                              {
                                 document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到控件</p></center>');
                                 top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                              }
                            }
                            catch(e)
                            {
                                document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">有错误，没有找到控件</p></center>');
                               top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                            }
                   }
                else
                {
                    document.write('<br><br><center><p style="font:bold 16px 微软雅黑;color:gray">文件不存在</p></center>');
                   top.ApplicationContext.MainFrame.SetMultimediaToolbarState(1);
                 }
                 
                if(eventList!=undefined && eventList.loadedImage!=undefined)
                    eventList.loadedImage();
                    
//                    if(axCGM!=undefined)
//                        axCGM.SRC=fullsrc;
//                  }
//                 catch(e)
//                 {
//                  //alert(e.description);
//                  top.MainFrame.SetMultimediaToolbarState(1);
//                 }
            }
        
        }
        
          function UrlExists(url)
        {
            var endIndex=url.indexOf('#');
	        var xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	        
	        if(endIndex!=-1)
	            url=url.substring(0,endIndex);
	        xmlhttp.open("GET", url, false);
	        try
	        {
		        xmlhttp.send();
		        
		        if (xmlhttp.status == 404)
		            return false;
		            
		        return true;
	        }
	        catch(e)
	        {
		        return false;
	        }
        }
        
        //101029，新增更新控件大小的方法，因为object无法跟随父容器大小变化而变化，该方法由父容器调用。
        function doresize()
        {
            axCGM.width=window.document.body.clientWidth;
            axCGM.height=window.document.body.clientHeight;
            axCGM.width="100%";
            axCGM.height="100%";
        }
    </script>
    
     <script src="resources/js/3D.js" type="text/javascript"></script>
</head>
<body scroll="no" leftmargin="0" rightmargin="0" topmargin="0" bottommargin="0"  onload="Init();">
<object classid="clsid:B6FCC215-D303-11D1-BC6C-0000C078797F" id="axCGM"  border="0" width="100%" height="100%">
        <PARAM name="ShowMainToolBar" value="1">
        <PARAM name="ShowAuxiToolBar" value="0">
        <PARAM name="ShowStatusBar" value="0">
        <PARAM name="ShowScrollBars" value="1">
        <PARAM name="EnablePopupMenu" value="1">
           <center>
            <p style="font:bold 16px 微软雅黑;color:gray"><br />检测到没有注册图像控件，请先注册！<br /></p>
            <p style="font:bold 16px 微软雅黑;color:gray"><br />请安装3D控件</p>
        </center>
      </object>  
</body>
</html>
