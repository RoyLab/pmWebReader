<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>图像浏览</title>
    <script language="javascript">
        ///设置媒体网址，如果src为空，则什么内容也不显示。type：0图形；type：1多媒体
        function SetSrc(src)
        {
            if(src!="")
            {
                var href = document.location.href;
                var lastpos = href.lastIndexOf('/') + 1;
                var fullsrc = href.substring(0, lastpos) + 'Manual/' + src;
                fullsrc=top.ApplicationContext.UserInfo.GetICNLocalizeUrl(fullsrc);
                axCGM.SourceFile = fullsrc;  
            }
        
        }
        
          function UrlExists(url)
        {
            var endIndex=url.indexOf('#');
	        var xmlhttp;
	        if(window.XMLHttpRequest)
	        {
	            xmlhttp=new XMLHttpRequest();
	        }
	        else if(window.ActiveXObject)
	        {
	            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	        }
	        
	        if(endIndex!=-1)
	            url=url.substring(0,endIndex);
	        xmlhttp.open("HEAD", url, true);
	        try
	        {
		        xmlhttp.send();
		        
		         if(xmlhttp.status==404)
		                return false;
		        
		        if (xmlhttp.readyState == 4 )
		        {
		            if(xmlhttp.status==200)
		                return true;
		        }
		         return false;
		            
	        }
	        catch(e)
	        {
		        return false;
	        }
        }
        
        ///cgm控件加载错误
        function LoadError()
        {
            downloadDIV.style.display = "";
        }
        
        function unloadobject()
        {
        
        }
    </script>

   <script language="javascript" for="axCGM" event="HotSpotHit(obj,e,key);">
        if(key==1)    //移动到上面key=0，单击key=1
        {
            if (top.MainFrame != null && top.MainFrame.GetContentPage() != null)
                top.MainFrame.GetContentPage().LocateHospot(obj,e);

//             if(typeof top.m_pnlContentMain.getFrameDoc().dom.Script.window.ContentPage === "undefined")
//                return;
//            top.m_pnlContentMain.getFrameDoc().dom.Script.window.ContentPage.LocateHospot(obj,e);
            
            //e.objectId    可以得到点击对象的ID
            //e.objectName  可以得到点击热点对象的name
            //根据这两个关键字到热点转换的a标签内去检索并获得href，然后讲内容页面导航到指定页面或指定位置
            //注意需要判断是页面内导航还是页面跳转
            
        }
    </script>
    
    <script src="resources/js/graphic_s.js" type="text/javascript"></script>
</head>
<body scroll="no" leftmargin="0" rightmargin="0" topmargin="0" bottommargin="0">
    <object id="axCGM" classid="clsid:8D59C559-929B-4D3E-99A2-C73BFF9AAF82" align="center" border="0" width="100%" height="100%" onerror="LoadError()">
        <param name="SourceFile" value="" />
        <param name="ShowScrollbar" value="1" />
        <param name="ShowToolbar" value="0" />
        <param name="ShowContextMenu" value="0" />
    </object>
 <div id="downloadDIV" style="display:none">
    控件加载失败，请点击<a href="resources/else/CGMReaderInstall.exe">下载</a>并安装控件.
 </div>    
</body>
</html>
